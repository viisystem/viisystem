!function($){"undefined"==typeof window.jurakit&&(window.jurakit={}),jurakit.grid={modalId:"modalId",modalInstance:null,modalMessage:null,loader:'<div class="loader">Loading...</div>',getParams:function(t){return title="undefined"==typeof t.attr("data-title")?$.t("WARNING"):t.attr("data-title"),message="undefined"==typeof t.attr("data-msg")?$.t("Are you sure you want to do this?"):t.attr("data-msg"),{title:title,message:message}},setSelectedRows:function(t){t.is(":checked")?t.parents(".table").find("tbody tr").addClass("active"):t.parents(".table").find("tbody tr").removeClass("active")},setSelectedRow:function(t){t.is(":checked")?t.parent().parent().addClass("active"):t.parent().parent().removeClass("active")},bulkAjax:function(t,a,e){$.ajax({url:a,type:"POST",dataType:"json",data:{keys:e},success:function(a){return pjaxContainer="#"+t.replace("grid","pjax"),1===a.s&&a.e>0&&$(pjaxContainer).length>0?(jurakit.form.pjaxReload(pjaxContainer),!1):a.hasOwnProperty("m")?(BootstrapDialog.show({type:BootstrapDialog.TYPE_DEFAULT,message:a.m,buttons:[{label:$.t("Close"),action:function(t){t.close()}}]}),!1):void 0}})},bulkAction:function(t,a,e){var o=$("#"+t).yiiGridView("getSelectedRows");o.length>0&&BootstrapDialog.confirm({title:$.t("WARNING"),message:$.t("Are you sure you want to do this?"),type:BootstrapDialog.TYPE_DEFAULT,closable:!0,btnCancelLabel:$.t("Cancel"),btnOKLabel:$.t("Ok"),btnOKClass:"btn-danger",callback:function(e){e&&jurakit.grid.bulkAjax(t,a,o)}})},bulkDelete:function(t,a,e){var o=$("#"+t).yiiGridView("getSelectedRows");o.length>0&&BootstrapDialog.confirm({title:$.t("WARNING"),message:$.t("Are you sure you want to delete?"),type:BootstrapDialog.TYPE_DEFAULT,closable:!0,btnCancelLabel:$.t("Cancel"),btnOKLabel:$.t("Delete"),btnOKClass:"btn-danger",callback:function(e){e&&jurakit.grid.bulkAjax(t,a,o)}})},status:function(t){$.ajax({url:t.attr("href"),type:"POST",dataType:"json",success:function(a){return pjax=t.data("pjax-container"),pjaxCallback=t.data("pjax-callback"),1===a.s&&"undefined"!=typeof pjax&&"undefined"!=typeof pjaxCallback&&(jurakit.form.pjaxReload("#"+pjax),jurakit.form.pjaxReload("#"+pjaxCallback)),1===a.s&&"undefined"!=typeof pjax?(jurakit.form.pjaxReload("#"+pjax),!0):1===a.s?(jurakit.form.pjaxReload("#"+t.parents(".grid-view").attr("id").replace("grid","pjax")),!0):0===a.s&&a.hasOwnProperty("m")?(BootstrapDialog.show({type:BootstrapDialog.TYPE_DANGER,title:$.t("WARNING"),message:a.m,buttons:[{label:$.t("Ok"),action:function(t){t.close()}}]}),!0):!1}})},"delete":function(obj){title="undefined"==typeof obj.attr("data-title")?$.t("WARNING"):obj.attr("data-title"),message="undefined"==typeof obj.attr("data-msg")?$.t("Are you sure you want to do this?"):obj.attr("data-msg"),BootstrapDialog.confirm({title:title,message:message,type:BootstrapDialog.TYPE_DEFAULT,closable:!0,btnCancelLabel:$.t("Cancel"),btnOKLabel:$.t("Ok"),btnOKClass:"btn-danger",callback:function(result){result&&(url=obj.attr("data-url"),"undefined"==typeof url&&(url=obj.attr("href")),$.ajax({url:url,type:"POST",dataType:"json",success:function(data){data.hasOwnProperty("m")&&BootstrapDialog.show({type:0===data.s?BootstrapDialog.TYPE_DANGER:BootstrapDialog.TYPE_DEFAULT,title:$.t("INFO"),message:data.m,buttons:[{label:$.t("Close"),action:function(t){t.close()}}]}),pjaxContainer="#"+(obj.is("[data-pjax-container]")?obj.attr("data-pjax-container"):obj.parents(".pjax-container").attr("id")),1===data.s&&$(pjaxContainer).length>0&&(paramsPjax={container:pjaxContainer,timeout:!1},paramsData=$(pjaxContainer).data("pjax-params"),"undefined"!=typeof paramsData&&$.extend(paramsPjax,paramsData),$.pjax.reload(paramsPjax)),ajaxContainer="#"+obj.attr("data-ajax-container"),1===data.s&&$(ajaxContainer).length>0&&data.hasOwnProperty("c")&&$(ajaxContainer).html(data.c),callFunction=obj.attr("data-func-success"),1===data.s&&null!=callFunction&&(callFunction.indexOf("(")>=0?eval(callFunction):eval(callFunction+"(params, data)"))}}))}})},confirm:function(t){jurakit.grid["delete"](t)},goLink:function(t){title="undefined"==typeof t.attr("data-title")?$.t("WARNING"):t.attr("data-title"),message="undefined"==typeof t.attr("data-msg")?$.t("Are you sure you want to do this?"):t.attr("data-msg"),BootstrapDialog.confirm({title:title,message:message,type:BootstrapDialog.TYPE_DEFAULT,closable:!0,btnCancelLabel:$.t("Cancel"),btnOKLabel:$.t("Ok"),btnOKClass:"btn-danger",callback:function(a){a&&(url=t.attr("data-url"),"undefined"==typeof url&&(url=t.attr("href")),window.location.href=url)}})},ordering:function(t,a){var e,o,n=$(t).sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="sortable-placeholder"/>',nested:!1,onDrag:function(t,a,e,o){t.css(a)},onDragStart:function(t,a,o,r){t.css({height:t.outerHeight(),width:t.outerWidth()}),t.addClass(a.group.options.draggedClass),$("body").addClass(a.group.options.bodyClass),e=JSON.stringify(n.sortable("serialize").get(),null,"")},onDrop:function(r,l,s,i){r.removeClass(l.group.options.draggedClass).removeAttr("style"),r.css({background:"#ffffaa"}).delay(600).queue(function(t){r.removeAttr("style"),t()}),$("body").removeClass(l.group.options.bodyClass),o=JSON.stringify(n.sortable("serialize").get(),null,""),e!==o&&$.ajax({url:a,type:"post",dataType:"json",data:{params:n.sortable("serialize").get()[0]},success:function(e){pjaxContainer="#"+$(t).parents(".pjax-container").attr("id"),1===e.s&&$(pjaxContainer).length>0&&(jurakit.form.pjaxReload(pjaxContainer),jurakit.grid.ordering(t,a))}})}})}}}(jQuery);